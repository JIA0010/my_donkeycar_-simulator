#!/bin/bash

# Donkey Car сѓисЃЪсЃЦсЃгсЃ╝сѓ┐сЃ╝ УЄфтІЋжЂІУ╗бсѓ╣сѓ»сЃфсЃЌсЃѕ
# Сй┐сЂёТќ╣: ./start_autopilot.sh

echo "­Ъцќ Donkey Car - УЄфтІЋжЂІУ╗бсЃбсЃ╝сЃЅУхитІЋ"
echo "=============================================="
echo ""

# сѓ╣сѓ»сЃфсЃЌсЃѕсЂ«сЃЄсѓБсЃгсѓ»сЃѕсЃфсѓњтЈќтЙЌ
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
cd "${SCRIPT_DIR}/mycar"

# сЃбсЃЄсЃФсЃЋсѓАсѓцсЃФсЂ«уб║УфЇ
if [ ! -f "models/mypilot.h5" ]; then
    echo "РЮї сѓесЃЕсЃ╝: тГду┐њТИѕсЂ┐сЃбсЃЄсЃФсЂїУдІсЂцсЂІсѓісЂЙсЂЏсѓЊ"
    echo "   тЁѕсЂФтГду┐њсѓњт«ЪУАїсЂЌсЂдсЂЈсЂасЂЋсЂё"
    echo "   ./train_model.sh сѓњт«ЪУАїсЂЌсЂдсЃбсЃЄсЃФсѓњСйюТѕљсЂЌсЂдсЂЈсЂасЂЋсЂё"
    exit 1
fi

echo "­ЪЊЮ С║ІтЅЇуб║УфЇ:"
echo "  1. сѓисЃЪсЃЦсЃгсЃ╝сѓ┐сЃ╝сѓбсЃЌсЃф(donkey_sim)сЂїУхитІЋсЂЌсЂдсЂёсЂЙсЂЎсЂІ№╝Ъ"
echo "  2. сѓисЃЪсЃЦсЃгсЃ╝сѓ┐сЃ╝сЂДУеГт«џсѓњт«їС║єсЂЌсђЂ3Dућ╗жЮбсЂїУАеуц║сЂЋсѓїсЂдсЂёсЂЙсЂЎсЂІ№╝Ъ"
echo "     (УеГт«џ: Scene=Generated Track, Graphics=Good, Port=9091)"
echo ""
read -p "Т║ќтѓЎсЂїсЂДсЂЇсЂЪсѓЅEnterсѓГсЃ╝сѓњТі╝сЂЌсЂдсЂЈсЂасЂЋсЂё..."

echo ""
echo "­Ъџђ УЄфтІЋжЂІУ╗бсЃбсЃ╝сЃЅсѓњУхитІЋсЂЌсЂЙсЂЎ..."
echo "   WebсЃќсЃЕсѓдсѓХсЂД http://localhost:8887 сЂФсѓбсѓ»сѓ╗сѓ╣сЂЌсЂдсЂЈсЂасЂЋсЂё"
echo "   Modeсѓњ 'Local Pilot' сЂЙсЂЪсЂ» 'Autopilot' сЂФтѕЄсѓіТЏ┐сЂѕсЂдсЂЈсЂасЂЋсЂё"
echo "   ухѓС║єсЂЎсѓІсЂФсЂ» Ctrl+C сѓњТі╝сЂЌсЂдсЂЈсЂасЂЋсЂё"
echo ""

# С╗«ТЃ│уњ░тбЃсЂ«PythonсѓњуЏ┤ТјЦСй┐ућесЂЌсЂдУЄфтІЋжЂІУ╗бсЃбсЃ╝сЃЅсѓњУхитІЋ
"${SCRIPT_DIR}/env/bin/python" manage.py drive --model ./models/mypilot.h5
